{% load static %}

<script>
    const sectionForm = document.getElementById('section-form');
    let current_user = {% if user.username == user_profile.user.username  and user.is_authenticated %} true {% else %}false {% endif %}

    sectionForm.addEventListener("submit", submitSectionHandler);
    function submitSectionHandler(e){
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url 'create-section' pk=experience.pk %}',
            data: $("#section-form").serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){
                    try {
                        document.getElementById('no-section').remove();
                    }catch {}



                    var section = '<div class="sub-section" id="sub-section-'+response.section_pk+'">\n' +
                        '    <div class="sub-section-header">\n' +
                        '        <div class="sub-section-heading">\n' +
                        '            <h2 class="sub-section-heading-text" id="sub-section-'+response.section_pk+'-name">\n' +
                        '                '+response.name+'\n' +
                        '            </h2>\n' +
                        '        </div>\n' +
                            '        <button type="button" data-toggle="modal" data-target="#add-experience-specific-'+response.section_pk+'"\n'
                            +
                            '                class="sub-section-button" style="font-size: 20px; color: #8a082c"><i class="fas fa-plus"></i></button>\n'
                            +
                            '        <button type="button" style="margin: 0; padding: 10px" class="option-button " id="uni-Button"\n'
                            +
                            '                data-toggle="dropdown"\n'+
                            '                aria-haspopup="true" aria-expanded="false">\n'+
                            '            <i class="fas fa-ellipsis-v"></i>\n'+
                            '        </button>\n'+
                            '        <div class="dropdown-menu" aria-labelledby="uni-Button">\n'+
                            '            <button class="dropdown-item" style="color: black" data-toggle="modal"\n'+
                            '                    data-target="#edit_section_card_'+response.section_pk+'">Edit\n'+
                            '            </button>\n'+
                            '            <form method="post" id="remove-section-'+response.section_pk+'-form" class="delete-object-form">\n'
                            +
                            '                {% csrf_token %}\n'+
                            '                ' + '{{ deleteSectionForm.as_p }}' + '\n'+
                            '                <button type="submit" class="dropdown-item" style="color: black">Remove</button>\n'
                            +
                            '            </form>\n'+
                            '        </div>\n'+
                            '        <div class="modal fade" id="edit_section_card_'+response.section_pk+'" tabindex="-1" aria-labelledby="edit_cardLabel"\n'
                            +
                            '             aria-hidden="true">\n'+
                            '            <div class="modal-dialog">\n'+
                            '                <div class="modal-content">\n'+
                            '                    <div class="modal-header">\n'+
                            '                        <h5 class="modal-title" id="edit_section_cardLabel_'+response.section_pk+'">Edit Project</h5>\n'
                            +
                            '                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n'
                            +
                            '                            <span aria-hidden="true">&times;</span>\n'+
                            '                        </button>\n'+
                            '                    </div>\n'+
                            '                    <div class="modal-body">\n'+
                            '                        <form method="post" id="edit-section-'+response.section_pk+'-form" class="edit-object-form">\n'
                            +
                            '                            {% csrf_token %}\n'+
                            '                            <div class="form-group">\n'+
                            '                               <div class="form-group">\n' +
                            '                                <label for="id_name">Name:</label><input type="text" name="name" maxlength="30" required="" id="id_name">\n' +
                            '                               </div>'+
                            '                            </div>\n'+
                            '                            <button type="submit" class="btn btn-primary"> Edit</button>\n'
                            +
                            '                        </form>\n'+
                            '                    </div>\n'+
                            '                </div>\n'+
                            '            </div>\n'+
                            '        </div>\n'+
                            '\n'+
                        '    </div>\n' +
                        '    <div class="modal fade" id="add-experience-specific-'+response.section_pk+'" tabindex="-1"\n' +
                        '         aria-labelledby="add-experience-specificLabel" aria-hidden="true">\n' +
                        '        <div class="modal-dialog">\n' +
                        '            <div class="modal-content">\n' +
                        '                <div class="modal-header">\n' +
                        '                    <h5 class="modal-title" id="add-experience-specificLabel">Add an '+response.name+' </h5>\n' +
                        '                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
                        '                        <span aria-hidden="true">&times;</span>\n' +
                        '                    </button>\n' +
                        '                </div>\n' +
                        '                <div class="modal-body">\n' +
                        '\n' +
                        '                    <form method="post" id="specific-form-'+response.section_pk+'" class="specific-form">\n' +
                        '                        {% csrf_token %}\n' +
                        '                        <div class="form-group row">\n' +
                        '                            <label for="id_position" class="col-sm-2 col-form-label">Position: </label>\n' +
                        '                            <div class="col-sm-10">\n' +
                        '                                {{ specificForm.position }}\n' +
                        '                            </div>\n' +
                        '                        </div>\n' +
                        '                        <div class="form-group row">\n' +
                        '                            <label for="id_company" class="col-sm-2 col-form-label">Company: </label>\n' +
                        '                            <div class="col-sm-10">\n' +
                        '                                {{ specificForm.company }}\n' +
                        '                            </div>\n' +
                        '                        </div>\n' +
                        '                        <div class="form-group">\n' +
                        '                            <label for="id_company" class="col-form-label">Description: </label>\n' +
                        '                            {{ specificForm.description }}\n' +
                        '                        </div>\n' +
                        '                        <div class="form-group row">\n' +
                        '                            <label for="id_company" class="col-sm-2 col-form-label">Link: </label>\n' +
                        '                            <div class="col-sm-10">\n' +
                        '                                {{ specificForm.link }}\n' +
                        '                            </div>\n' +
                        '                        </div>\n' +
                        '                        <button type="submit" class="btn btn-primary specific-form-submit">Add</button>\n' +
                        '                    </form>\n' +
                        '                </div>\n' +
                        '            </div>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '    <div class="sub-section-container" id="sub-section-container">\n' +
                        '        <ul class="list-unstyled" id="sub-section-list-'+response.section_pk+'">\n' +
                            '            <li style="background-color: transparent; border: none" class="card" id="no-specific">\n'
                            +
                            '                <div class="card-body" style="padding: 0 0 0 0.6rem">\n'+
                            '                    Click on + to add '+response.name+'\n'+
                            '                </div>\n'+
                            '            </li>\n'+
                        '        </ul>\n' +
                        '    </div>\n' +
                        '</div>';

                     $("#experience-container").append(section);
                     var elem_id = "specific-form-" + response.section_pk;

                     var newForm = document.getElementById(elem_id);
                     newForm.addEventListener("submit", submitSpecificHandler);

                     elem_id = "edit-section-" + response.section_pk +"-form";
                     newForm = document.getElementById(elem_id);
                     newForm.addEventListener("submit", submitEditHandler);

                     elem_id = 'remove-section-'+response.section_pk+'-form';
                     newForm = document.getElementById(elem_id);
                     newForm.addEventListener("submit", submitDeleteHandler);

                }
            }
        })
    }
    var specificForms = document.getElementsByClassName("specific-form");
      for (i = 0; i < specificForms.length; i++) {
        specificForms[i].addEventListener("submit", submitSpecificHandler);
      }

    {#$(document).on('submit', 'form.specific-form', submitSpecificHandler);#}
    function submitSpecificHandler(e){
        e.preventDefault();
        var form_id = this.id;
        var sec_pk = form_id.substring('specific-form-'.length);
        var url = '{% url 'specific-url' %}/'  + sec_pk;
        $.ajax({
            type: 'POST',
            url: url,
            data: $('#'+form_id).serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){

                    try {
                        document.getElementById('no-specific').remove();
                     }catch {}

                    var specific = '            <li class="media" style="margin: 10px 10px 18px 10px" id="specific-'+response.specific_pk+'">\n'
                        +
                        '                {# <img src="{% static \'collegehub/images/blue_marble.jpg\' %}" class="mr-3 edu-card-img" alt="..." #}\n'
                        +
                        '                        {# width="150" height="100"> #}\n'+
                        '                <div class="media-body">\n'+
                        '                    <div style="display: flex;" class="edit_mode">\n'+
                        '                        <h4 class=" mt-0 mb-1 "\n'+
                        '                            id="specific-'+response.specific_pk+'-position" data-toggle="modal"\n'+
                        '                            data-target="#edit_specific_card_'+response.specific_pk+'" type="submit">\n'
                        +
                        '                            '+response.position+'\n'+
                        '                        </h4>\n'+
                        '                        <form method="post" id="remove-specific-'+response.specific_pk+'-form" class="delete-object-form">\n'
                        +
                        '                            {% csrf_token %}\n'+
                        '                            ' + '{{ deleteSpecificForm.as_p }}' + '\n'+
                        '                            <button type="submit" class="remove_exp_card" style=""><i class="far fa-trash-alt"></i></button>\n'
                        +
                        '                        </form>\n'+
                        '                    </div>\n';
                        if(response.company!='' && response != 'None'){
                             specific += '                    <h5 class="mt-0 mb-1" style="color: #9cae00" id="specific-'+response.specific_pk+'-company">\n'
                            +
                            '                        '+response.company+'</h5>\n';
                        }
                        specific += '                    <p style="margin-bottom: 10px; font-weight: lighter" id="specific-'+response.specific_pk+'-description">\n' +
                        '                        '+response.description+'\n'+
                        '                    </p>\n';
                        if(response.link != '' && response.link != '/' && response.link != 'None' && response.link != '\\'){
                            specific += '                    <a href="'+response.link+'" class="btn btn-outline-danger" style="border-radius: 4rem"\n' +
                            '                       id="specific-'+response.specific_pk+'-link"><i\n'+
                            '                            class="fas fa-external-link-square-alt" aria-hidden="true"> </i> Link</a>\n';
                        }
                       specific += '                </div>\n'+
                        '                <div class="modal fade" id="edit_specific_card_'+response.specific_pk+'" tabindex="-1"\n'
                        +
                        '                     aria-labelledby="edit_cardLabel"\n'+
                        '                     aria-hidden="true">\n'+
                        '                    <div class="modal-dialog">\n'+
                        '                        <div class="modal-content">\n'+
                        '\n'+
                        '                            <div class="modal-header">\n'+
                        '                                <h5 class="modal-title" id="edit_specific_cardLabel_'+response.specific_pk+'">Edit Skill</h5>\n'
                        +
                        '                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n'
                        +
                        '                                    <span aria-hidden="true">&times;</span>\n'+
                        '                                </button>\n'+
                        '                            </div>\n'+
                        '\n'+
                        '                            <div class="modal-body">\n'+
                        '                                <form method="post" id="edit-specific-'+response.specific_pk+'-form" class="edit-object-form">\n'
                        +
                        '                                    {% csrf_token %}\n'+
                        '<div class="form-group">\n' +
                           '                                        <label for="id_position">Position:</label><input type="text" name="position" maxlength="50" required="" id="id_position">\n' +
                           '<label for="id_company">Company:</label><input type="text" name="company" maxlength="50" id="id_company">\n' +
                           '<label for="id_description">Description:</label><input type="text" name="description" value="This is what I did" maxlength="2000" required="" id="id_description">\n' +
                           '<label for="id_link">Link:</label><input type="url" name="link" maxlength="200" id="id_link">\n' +
                           '                                    </div>'+
                        '                                    <button type="submit" class="btn btn-primary"> Edit</button>\n'
                        +
                        '                                </form>\n'+
                        '                            </div>\n'+
                        '                        </div>\n'+
                        '                    </div>\n'+
                        '                </div>\n'+
                        '\n'+
                        '            </li>\n';

                $("#sub-section-list-"+sec_pk).append(specific);
                var elem_id = "edit-specific-" + response.specific_pk +"-form";
                var newForm = document.getElementById(elem_id);
                newForm.addEventListener("submit", submitEditHandler);

                elem_id = 'remove-specific-'+response.specific_pk+'-form';
                newForm = document.getElementById(elem_id);
                newForm.addEventListener("submit", submitDeleteHandler);
                }
            }
        })
    }



    const educationForm = document.getElementById('education-form');
educationForm.addEventListener("submit", submitEducationHandler);
function submitEducationHandler(e){
    e.preventDefault();
    $.ajax({
        type: 'POST',
        url: '{% url 'create-education' pk=user_profile.pk %}',
        data: $("#education-form").serialize(),
        dataType: 'json',
        success: function (response) {
            if(!response.fail){
                try {
                    document.getElementById('no-education').remove();
                }catch {}

                var education = '<div class="card mb-3 marg-20 edu-card" id="education-'+response.education_pk+'" style="width: 540px;border-radius: 1rem">\n' +
                    '        <div class="row no-gutters">\n' +
                    '{#            <div class="col-md-4">#}\n' +
                    '{#                <img src="{{ education.image }}" class="card-img" alt="edu-logo">#}\n' +
                    '{#            </div>#}\n' +
                    '            <div class="col-md-12">\n' +
                    '\n' +
                        '                    <div class="dropdown ">\n'+
                        '                        <button type="button" class="option-button" id="uni-Button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n' +
                        '                            <i class="fas fa-ellipsis-v"></i>\n'+
                        '                        </button>\n'+
                        '\n'+
                        '                         <div class="dropdown-menu" aria-labelledby="uni-Button">\n'+
                        '                            <button class="dropdown-item" style="color: black" data-toggle="modal" data-target="#edit_education_card_'+response.education_pk+'">Edit</button>\n' +
                        '                            <form method="post" id="remove-education-'+response.education_pk+'-form" class="delete-object-form">\n' +
                        '                                {% csrf_token %} \n'+
                        '                                ' + '{{ deleteEducationForm.as_p }}' + ' \n'+
                        '                                <button type="submit" class="dropdown-item" style="color: black"> Remove </button>\n'+
                        '                            </form>\n'+
                        '                        </div>\n'+
                        '                    </div>\n'+
                        '\n'+
                        '                    <div class="modal fade" id="edit_education_card_'+response.education_pk+'" tabindex="-1" aria-labelledby="edit_cardLabel" aria-hidden="true">\n' +
                        '                        <div class="modal-dialog">\n'+
                        '                            <div class="modal-content">\n'+
                        '\n'+
                        '                                <div class="modal-header">\n'+
                        '                                    <h5 class="modal-title" id="edit_education_cardLabel_'+response.education_pk+'">Edit Education card</h5>\n' +
                        '                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
                        '                                        <span aria-hidden="true">&times;</span>\n'+
                        '                                    </button>\n'+
                        '                                </div>\n'+
                        '\n'+
                        '                                <div class="modal-body">\n'+
                        '                                   <form method="post" id="edit-education-'+response.education_pk+'-form" class="edit-object-form">\n'+
                        '                                            {% csrf_token %} \n' +
                        '<p><label for="id_institution">Institution:</label> <input type="text" name="institution" maxlength="50" required id="id_institution"></p>'+
                        '<p><label for="id_certification_name">Certification name:</label> <input type="text" name="certification_name" maxlength="50" required id="id_certification_name"></p>'+
                        '<p><label for="id_description">Description:</label> <input type="text" name="description" maxlength="280" required id="id_description"></p>'+
                        '<p><label for="id_month">Month:</label> <input type="text" name="month" value="01" maxlength="2" required id="id_month"></p>'+
                        '<p><label for="id_year">Year:</label> <input type="text" name="year" value="9999" maxlength="4" required id="id_year"></p>'+
                        '                                       <button type="submit"> Edit </button>\n'+
                        '                                   </form>\n'+
                        '                                </div>\n'+
                        '\n'+
                        '                            </div>\n'+
                        '                        </div>\n'+
                        '                    </div>\n'+
                    '\n' +
                    '\n' +
                    '                <div class="card-body">\n';

                    if(response.institution != '' && response.institution != 'None'){
                           education += '                        <h5 id="education-'+response.education_pk+'-institution" class="card-text uniname">'+ response.institution +'</h5>\n';
                    }
                    education += '                    <h6 id="education-'+response.education_pk+'-certification_name" class="card-title major"> '+ response.certification_name +'</h6>\n';
                    if(response.description != '' && response.description != 'None'){
                        education += '                        <h6 id="education-'+response.education_pk+'-description" class="card-text edu-description">'+ response.description +'</h6>\n';
                    }
                    education += '                    <p id="education-'+response.education_pk+'-date" class="card-text"><small class="text-muted year">Date: '+ response.month +'/'+ response.year +'</small></p>\n' +
                    '                </div>\n' +
                    '            </div>\n' +
                    '        </div>\n' +
                    '\n' +
                    '    </div>';

                $("#education-container").append(education);
                 var elem_id = "edit-education-" + response.education_pk +"-form";
                 var newForm = document.getElementById(elem_id);
                 newForm.addEventListener("submit", submitEditHandler);

                 elem_id = 'remove-education-'+response.education_pk+'-form';
                 newForm = document.getElementById(elem_id);
                 newForm.addEventListener("submit", submitDeleteHandler);
            }
        }
    })
}

    const skillForm = document.getElementById('skill-form');

    skillForm.addEventListener("submit", submitSkillHandler);
    function submitSkillHandler(e){
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url 'create-skill' pk=user_profile.pk %}',
            data: $("#skill-form").serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){

                    try {
                        document.getElementById('no-skill').remove();
                    }catch {}

                    var skill = '<div class="card mb-3" style="align-items:center;display: flex;flex-direction:row;justify-content:space-between;border-radius: 4rem;background-image: linear-gradient(50deg, #214252 0%, #376f8a 74%);max-width: 18rem; border: #9da724 3px solid" id="skill-'+response.skill_pk+'">\n' +
                        '    <div class="skill-header" id="skill-'+response.skill_pk+'-name" style="color: white">'+response.name+'</div>\n' +
                        '    <button type="button" style="margin: 0" class="option-button" id="uni-Button" data-toggle="dropdown"\n' +
                        '            aria-haspopup="true" aria-expanded="false">\n' +
                        '        <i class="fas fa-ellipsis-v"></i>\n' +
                        '    </button>\n' +
                        '    <div class="dropdown-menu" aria-labelledby="uni-Button">\n' +
                        '        <button class="dropdown-item" style="color: black" data-toggle="modal" data-target="#edit_skill_card_'+response.skill_pk+'">Edit</button>\n' +
                        '        <form method="post" id="remove-skill-'+response.skill_pk+'-form" class="delete-object-form">\n' +
                        '            {% csrf_token %}\n' +
                        '            '+ '{{ deleteSkillForm.as_p }}' +'\n' +
                        '            <button type="submit" class="dropdown-item" style="color: black">Remove</button>\n' +
                        '        </form>\n' +
                        '    </div>\n' +
                        '    <div class="modal fade" id="edit_skill_card_'+response.skill_pk+'" tabindex="-1" aria-labelledby="edit_cardLabel"\n' +
                        '         aria-hidden="true">\n' +
                        '        <div class="modal-dialog">\n' +
                        '            <div class="modal-content">\n' +
                        '\n' +
                        '                <div class="modal-header">\n' +
                        '                    <h5 class="modal-title" id="edit_skill_cardLabel_'+response.skill_pk+'">Edit Skill</h5>\n' +
                        '                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
                        '                        <span aria-hidden="true">&times;</span>\n' +
                        '                    </button>\n' +
                        '                </div>\n' +
                        '\n' +
                        '                <div class="modal-body">\n' +
                        '                   <form method="post" id="edit-skill-'+response.skill_pk+'-form" class="edit-object-form">\n' +
                        '                            {% csrf_token %}\n' +
                        '                <div class="form-group">\n' +
                        '                  <label for="id_name">Name:</label><input type="text" name="name" maxlength="30" required="" id="id_name">\n' +
                        '                </div>' +
                        '                       <button type="submit" class="btn btn-primary"> Edit </button>\n' +
                        '                   </form>\n' +
                        '                </div>\n' +
                        '            </div>\n' +
                        '        </div>\n' +
                        '    </div>\n' +
                        '</div>';

                    $("#skills-container").append(skill);

                    var elem_id = "edit-skill-" + response.skill_pk + "-form";
                    var newForm = document.getElementById(elem_id);
                    newForm.addEventListener("submit", submitEditHandler);

                    elem_id = 'remove-skill-' + response.skill_pk + '-form';
                    newForm = document.getElementById(elem_id);
                    newForm.addEventListener("submit", submitDeleteHandler);
                }
            }
        })
    }

    const projectForm = document.getElementById('project-form');

    projectForm.addEventListener("submit", submitProjectHandler);
    function submitProjectHandler(e){
        e.preventDefault();
        $.ajax({
            type: 'POST',
            url: '{% url 'create-project' pk=user_profile.pk %}',
            data: $("#project-form").serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){
                    try {
                        document.getElementById('no-project').remove();
                    }catch {}

                    var project = '<div class="card" style="width: 900px;box-shadow: -30px 0 30px 0 lightgrey;border: #9da724 1px solid; border-bottom-right-radius: 3rem;border-bottom-left-radius: 3rem" id="project-'+response.project_pk+'">\n' +
                        '    <div class="card-header" style="background-image: linear-gradient(50deg, #214252 0%, #376f8a 74%);border-bottom-right-radius: 1rem;border-bottom-left-radius: 1rem; ">\n' +
                        '        <span style="font-weight: bold;font-size: 24px; color:#cbe206;" id="project-'+response.project_pk+'-name">\n' +
                        '            '+response.name+'\n' +
                        '        </span>\n' +
                        '        <button type="button" style="margin: 0; padding: 0" class="option-button" id="uni-Button" data-toggle="dropdown"\n' +
                        '                aria-haspopup="true" aria-expanded="false">\n' +
                        '            <i class="fas fa-ellipsis-v"></i>\n' +
                        '        </button>\n' +
                        '        <div class="dropdown-menu" aria-labelledby="uni-Button">\n' +
                        '            <button class="dropdown-item" style="color: black" data-toggle="modal"\n' +
                        '                    data-target="#edit_project_card_'+response.project_pk+'">Edit\n' +
                        '            </button>\n' +
                        '            <form method="post" id="remove-project-'+response.project_pk+'-form" class="delete-object-form">\n' +
                        '                {% csrf_token %}\n' +
                        '                '+ '{{ deleteProjectForm.as_p }}' +'\n' +
                        '                <button type="submit" class="dropdown-item" style="color: black">Remove</button>\n' +
                        '            </form>\n' +
                        '        </div>\n' +
                        '        <div class="modal fade" id="edit_project_card_'+response.project_pk+'" tabindex="-1" aria-labelledby="edit_cardLabel"\n' +
                        '             aria-hidden="true">\n' +
                        '            <div class="modal-dialog">\n' +
                        '                <div class="modal-content">\n' +
                        '                    <div class="modal-header">\n' +
                        '                        <h5 class="modal-title" id="edit_project_cardLabel_'+response.project_pk+'">Edit Project</h5>\n' +
                        '                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n' +
                        '                            <span aria-hidden="true">&times;</span>\n' +
                        '                        </button>\n' +
                        '                    </div>\n' +
                        '                    <div class="modal-body">\n' +
                        '                        <form method="post" id="edit-project-'+response.project_pk+'-form" class="edit-object-form">\n' +
                        '                            {% csrf_token %}\n' +
                        '                           <div class="form-group">\n' +
                        '                                <label for="id_name">Name:</label><input type="text" name="name" maxlength="50" required="" id="id_name">\n' +
                        '<label for="id_description">Description:</label><input type="text" name="description" value="This is what I did" maxlength="2000" required="" id="id_description">\n' +
                        '<label for="id_month">Month:</label><input type="text" name="month" maxlength="2" id="id_month">\n' +
                        '<label for="id_year">Year:</label><input type="text" name="year" value="9999" maxlength="4" required="" id="id_year">\n' +
                        '                            </div>'+
                        '                            <button type="submit" class="btn btn-primary"> Edit</button>\n' +
                        '                        </form>\n' +
                        '                    </div>\n' +
                        '                </div>\n' +
                        '            </div>\n' +
                        '        </div>\n' +
                        '\n' +
                        '    </div>\n' +
                        '\n' +
                        '    <div class="card-body">\n' +
                        '        <blockquote class="blockquote mb-0">\n' +
                        '            <p id="project-'+response.project_pk+'-description" style="font-weight: lighter">'+response.description+'</p>\n' +
                        '            <footer class="blockquote-footer" id="project-'+response.project_pk+'-date">\n';
                        if (response.month != '' && response.month != 'None'){
                            project += '                '+response.month+' / ';
                        }
                        project += response.year+'\n' +
                        '            </footer>\n' +
                        '        </blockquote>\n' +
                        '    </div>\n' +
                        '\n' +
                        '</div>';

                    console.log(project);
                    $("#projects-container").append(project);

                    var elem_id = "edit-project-" + response.project_pk + "-form";
                    var newForm = document.getElementById(elem_id);
                    newForm.addEventListener("submit", submitEditHandler);

                    elem_id = 'remove-project-' + response.project_pk + '-form';
                    newForm = document.getElementById(elem_id);
                    newForm.addEventListener("submit", submitDeleteHandler);
                }else{alert('Form was not filled in correctly, please enter the required information')}
            }
        })
    }

    var deletionForms = document.getElementsByClassName("delete-object-form");
    for (i = 0; i < deletionForms.length; i++) {
        deletionForms[i].addEventListener("submit", submitDeleteHandler);
      }
    function submitDeleteHandler(e){
        e.preventDefault();
        var form_id = this.id;
        var split_string = form_id.split("-");
        var obj_type = split_string[1];
        var obj_pk = split_string[2];
        if(obj_type == 'education'){
            var url = '{% url 'delete-education' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'section'){
             var url = '{% url 'delete-section' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'specific'){
             var url = '{% url 'delete-specific' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'skill'){
             var url = '{% url 'delete-skill' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'project'){
            var url = '{% url 'delete-project' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }
        $.ajax({
            type: 'POST',
            url: url,
            data: $('#'+form_id).serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){
                    if (obj_type == 'section'){
                        $("#sub-"+obj_type+'-'+obj_pk).remove();
                    }else{
                        console.log("#"+obj_type+'-'+obj_pk);
                        $("#"+obj_type+'-'+obj_pk).remove();
                    }

                }
            }
        })
    }

    var editForms = document.getElementsByClassName("edit-object-form");
    for (i = 0; i < editForms.length; i++) {
        editForms[i].addEventListener("submit", submitEditHandler);
      }
    function submitEditHandler(e){
        e.preventDefault();
        var form_id = this.id;
        var split_string = form_id.split("-");
        var obj_type = split_string[1];
        var obj_pk = split_string[2];
        if(obj_type == 'education'){
            var url = '{% url 'edit-education' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'section'){
             var url = '{% url 'edit-section' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'specific'){
             var url = '{% url 'edit-specific' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'skill'){
             var url = '{% url 'edit-skill' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }else if(obj_type == 'project'){
            var url = '{% url 'edit-project' pk=1%}';
            url = url.slice(0, -1) + obj_pk;
        }
        $.ajax({
            type: 'POST',
            url: url,
            data: $('#'+form_id).serialize(),
            dataType: 'json',
            success: function (response) {
                if(!response.fail){
                    if (obj_type == 'section'){
                        document.getElementById('sub-'+obj_type+'-'+obj_pk+'-'+'name').innerText = response.name;

                    }else if (obj_type == 'specific'){
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'position').innerText = response.position;
                        if(response.company != '' && response.company != 'None') {
                            document.getElementById(obj_type + '-' + obj_pk + '-' + 'company').innerText = response.company;
                        }
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'description').innerText = response.description;
                        if(response.link != '' && response.link != 'None'){
                            document.getElementById(obj_type+'-'+obj_pk+'-'+'date').href = response.link;
                        }

                    }else if (obj_type == 'education'){
                        if(response.institution != '' && response.institution != 'None') {
                            document.getElementById(obj_type + '-' + obj_pk + '-' + 'institution').innerText = response.institution;
                        }
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'certification_name').innerText = response.certification_name;
                        if(response.description != '' && response.description != 'None') {
                            document.getElementById(obj_type + '-' + obj_pk + '-' + 'description').innerText = response.description;
                        }
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'date').innerText = 'Date:' + response.month +'/'+ response.year;

                    }else if (obj_type == 'skill'){
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'name').innerText = response.name;

                    }else if (obj_type == 'project'){
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'name').innerText = response.name;
                        document.getElementById(obj_type+'-'+obj_pk+'-'+'description').innerText = response.description;
                        if(response.month != '' && response.month != 'None') {
                            console.log('YOO');
                            document.getElementById(obj_type + '-' + obj_pk + '-' + 'date').innerText = response.month + '/' + response.year;
                         }else{
                            console.log('Yeerr');
                            console.log( document.getElementById(obj_type + '-' + obj_pk + '-' + 'date').innerText);
                            document.getElementById(obj_type + '-' + obj_pk + '-' + 'date').innerText = response.year;
                         }



                    }

                }
            }
        })
    }
</script>